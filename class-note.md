---

### **《Istio 服务网格实战教科书》课程大纲**

#### **第一章：服务网格的崛起与 Istio 架构 (基础篇)**
> **目标：** 建立对 Istio 的全貌认知，理解服务网格的由来和核心框架。
1. **1.1 微服务架构的“成长的烦恼”**
   - 微服务的常见痛点（如服务雪崩、复杂运维）。
   - 服务网格如何解决这些问题。
2. **1.2 Istio 架构演进**
   - 控制平面 (Istiod) vs 数据平面 (Envoy)。
   - Istio 1.26 的特性，Sidecar 模式 vs Ambient Mesh。
3. **1.3 实战：Istio 环境安装** （Lab 1）
   - 使用 `istioctl` 安装并验证运行状态。
   - 深入分析 `istioctl` 安装的 K8s 资源与 CRD。

---

#### **第二章：数据平面的魔法 —— Sidecar 与应用接入 (接入篇)**
> **目标：** 理解 Sidecar 的核心功能与工作机制。
1. **2.1 Envoy 代理基础**
   - Envoy 的线程模型、xDS 协议工作原理。
2. **2.2 示例应用 Bookinfo 部署** （Lab 2）
   - 部署 Bookinfo 示例程序，分析微服务调用关系。
3. **2.3 Sidecar 注入机制**
   - 自动注入与手动注入对比。
   - `istio-init` 容器的流量劫持原理。
   - 验证 Sidecar 日志，解析代理的启动过程。

---

#### **第三章：流量治理 —— 运筹帷幄 (核心篇)**
> **目标：** 学会东西向（服务间）与南北向（外部入口）流量控制。
1. **3.1 Istio 流量模型**
   - VirtualService 和 DestinationRule 的区别。
2. **3.2 南北向流量** （Lab 3.3, 3.5）
   - 使用 Gateway 和 VirtualService 暴露服务。
   - 深入剖析流量进入服务网格的路径。
3. **3.3 东西向路由与版本管理** （Lab 3.1）
   - 根据请求 Header 路由流量到不同服务版本。
4. **3.4 灰度发布与流量转移** （Lab 3.2）
   - 使用权重实现不同版本流量动态切换。
5. **3.5 外部服务流量管控** （Lab 3.4, 3.6）
   - 配置 ServiceEntry 和 Egress Gateway 管理外部服务访问。

---

#### **第四章：弹性与韧性 —— 构建不倒翁系统 (进阶篇)**
> **目标：** 学会通过 Istio 配置实现应用的高可用和容错能力。
1. **4.1 超时与重试** （Lab 4.1）
   - 模拟网络问题导致的超时，配置 Retry 策略解决问题。
2. **4.2 熔断保护与连接池管理** （Lab 4.2）
   - 配置 DestinationRule 的 `outlierDetection`，触发熔断行为。

---

#### **第五章：故障注入与调试 —— 混沌工程入门 (测试篇)**
> **目标：** 学习如何通过故障注入找到潜在问题，并熟练使用流量镜像功能。
1. **5.1 故障注入** （Lab 5.1）
   - 主动加入延迟与错误响应测试程序的稳定性。
2. **5.2 流量镜像** （Lab 5.2）
   - 把生产流量复制到新版本，进行影子测试。

---

#### **第六章：零信任安全 —— 守卫网格 (安全篇)**
> **目标：** 配置和验证 Istio 的安全特性，例如 mTLS 和授权策略。
1. **6.1 边界层安全：Ingress TLS 配置** （Lab 6）
   - 配置双向 TLS，结合 SDS（Secret Discovery Service）。
2. **6.2 内部服务安全：mTLS 配置** （Lab 7）
   - 验证从 PERMISSIVE 到 STRICT 模式的切换。
3. **6.3 请求认证与授权策略** （Lab 8）
   - 配置 JWT 验证与基于角色的访问控制。

---

#### **第七章：可观测性 —— 看见看不见的 (运维篇)**
> **目标：** 使用 Istio 的监控工具收集服务调用链与性能指标。
1. **7.1 分布式调用链与日志分析** （Lab 9.1, 9.4）
   - 使用 Jaeger 和 Envoy 日志追踪调用链。
2. **7.2 错误与请求监控** （Lab 9.2, 9.3）
   - 使用 Prometheus 和 Grafana 可视化网格指标，分析性能问题。

---

#### **附录**
1. Kubernetes 基础知识快速补充
2. 各章节实验配置文件和命令说明
3. 常见问题处理 FAQ

---